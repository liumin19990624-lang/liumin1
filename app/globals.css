@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================
   1. 根变量配置（适配深色主题）
   ============================ */
:root {
  /* 浅色主题变量（默认） */
  --foreground-rgb: 30, 41, 59; /* 深灰蓝（主文本） */
  --foreground-secondary-rgb: 100, 116, 139; /* 中灰（次要文本） */
  --background-start-rgb: 248, 250, 252; /* 浅灰蓝（背景开始） */
  --background-end-rgb: 255, 255, 255; /* 白色（背景结束） */
  --border-rgb: 226, 232, 240; /* 浅灰（边框） */
  --primary-rgb: 59, 130, 246; /* 蓝色（主色） */
  --scrollbar-thumb-rgb: 148, 163, 184; /* 中灰（滚动条滑块） */
  --scrollbar-track-rgb: 241, 245, 249; /* 浅灰（滚动条轨道） */
}

/* 深色主题变量（优先适配项目风格） */
@media (prefers-color-scheme: dark) {
  :root {
    --foreground-rgb: 248, 250, 252; /* 浅灰（主文本） */
    --foreground-secondary-rgb: 148, 163, 184; /* 中灰（次要文本） */
    --background-start-rgb: 10, 10, 10; /* 近黑（背景开始） */
    --background-end-rgb: 15, 15, 15; /* 近黑（背景结束） */
    --border-rgb: 45, 55, 72; /* 深灰（边框） */
    --primary-rgb: 96, 165, 250; /* 亮蓝（主色） */
    --scrollbar-thumb-rgb: 51, 65, 85; /* 深灰（滚动条滑块） */
    --scrollbar-track-rgb: 23, 23, 23; /* 近黑（滚动条轨道） */
  }
}

/* 强制深色主题（如需全局强制启用） */
/* 
:root {
  --foreground-rgb: 248, 250, 252;
  --foreground-secondary-rgb: 148, 163, 184;
  --background-start-rgb: 10, 10, 10;
  --background-end-rgb: 15, 15, 15;
  --border-rgb: 45, 55, 72;
  --primary-rgb: 96, 165, 250;
  --scrollbar-thumb-rgb: 51, 65, 85;
  --scrollbar-track-rgb: 23, 23, 23;
}
*/

/* ============================
   2. 基础样式重置与统一
   ============================ */
@layer base {
  html,
  body,
  #root {
    @apply h-full w-full overflow-hidden;
    font-feature-settings: "cv02", "cv03", "cv04", "cv11"; /* 优化字体显示 */
  }

  body {
    @apply text-[rgb(var(--foreground-rgb))] antialiased;
    background: linear-gradient(
        to bottom,
        transparent,
        rgb(var(--background-end-rgb))
      )
      rgb(var(--background-start-rgb));
  }

  /* 统一所有元素的盒模型 */
  *,
  *::before,
  *::after {
    @apply box-border;
  }

  /* 统一表单元素样式 */
  input,
  select,
  textarea,
  button {
    @apply focus:outline-none focus:ring-1 focus:ring-[rgb(var(--primary-rgb))] focus:ring-offset-1 focus:ring-offset-[rgb(var(--background-start-rgb))];
  }

  /* 统一标题样式 */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply font-black tracking-tight;
  }

  /* 统一链接样式 */
  a {
    @apply text-[rgb(var(--primary-rgb))] hover:text-[rgb(var(--primary-rgb)/80)] transition-colors;
  }
}

/* ============================
   3. 自定义组件类（复用样式）
   ============================ */
@layer components {
  /* 玻璃态效果（适配深色/浅色主题） */
  .glass-effect {
    @apply bg-white/85 dark:bg-black/85 backdrop-blur-xl saturate-180 border border-white/40 dark:border-black/40;
  }

  /* 深色主题玻璃态（单独优化） */
  .glass-effect-dark {
    @apply bg-[rgb(15,15,15)/80] backdrop-blur-xl saturate-180 border border-[rgb(45,55,72)/50];
  }

  /* 卡片容器样式 */
  .card-container {
    @apply bg-[rgb(var(--background-start-rgb))] border border-[rgb(var(--border-rgb))] rounded-2xl shadow-lg p-4 md:p-6 transition-all;
  }

  /* 按钮基础样式 */
  .btn-base {
    @apply font-black text-xs uppercase rounded-xl transition-all duration-300 flex items-center justify-center gap-2;
  }

  /* 主按钮样式 */
  .btn-primary {
    @apply btn-base bg-[rgb(var(--primary-rgb))] text-white hover:bg-[rgb(var(--primary-rgb)/90)] active:scale-95 shadow-lg;
  }

  /* 次要按钮样式 */
  .btn-secondary {
    @apply btn-base bg-transparent border border-[rgb(var(--border-rgb))] text-[rgb(var(--foreground-rgb))] hover:bg-[rgb(var(--border-rgb)/20)];
  }

  /* 危险按钮样式 */
  .btn-danger {
    @apply btn-base bg-rose-600 text-white hover:bg-rose-700 active:scale-95;
  }

  /* 表单输入框基础样式 */
  .form-input {
    @apply w-full bg-[rgb(var(--background-start-rgb))] border border-[rgb(var(--border-rgb))] rounded-xl px-4 py-3 text-sm font-medium text-[rgb(var(--foreground-rgb))] placeholder:text-[rgb(var(--foreground-secondary-rgb))];
  }
}

/* ============================
   4. 自定义工具类（扩展功能）
   ============================ */
@layer utilities {
  /* 滚动条样式（统一深色/浅色主题） */
  .custom-scrollbar::-webkit-scrollbar {
    @apply w-2 h-2;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    @apply bg-[rgb(var(--scrollbar-track-rgb))] rounded-full;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    @apply bg-[rgb(var(--scrollbar-thumb-rgb))] rounded-full border-2 border-transparent bg-clip-content-box hover:bg-[rgb(var(--scrollbar-thumb-rgb)/80)] transition-colors;
  }

  .custom-scrollbar::-webkit-scrollbar-corner {
    @apply bg-transparent;
  }

  /* 平滑滚动（如需局部滚动） */
  .smooth-scroll {
    @apply scroll-smooth;
  }

  /* 文本渐变 */
  .text-gradient {
    @apply bg-clip-text text-transparent bg-gradient-to-r from-[rgb(var(--primary-rgb))] to-blue-400;
  }

  /* 内容溢出省略（单行） */
  .text-ellipsis {
    @apply overflow-hidden text-ellipsis whitespace-nowrap;
  }

  /* 内容溢出省略（多行） */
  .text-ellipsis-multiline {
    @apply overflow-hidden -webkit-line-clamp-2 -webkit-box-orient-vertical;
  }

  /* 动画延迟工具类 */
  .animate-delay-100 {
    animation-delay: 100ms;
  }

  .animate-delay-200 {
    animation-delay: 200ms;
  }

  .animate-delay-300 {
    animation-delay: 300ms;
  }
}

/* ============================
   5. 动画定义（统一动画效果）
   ============================ */
@keyframes fade-up {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-up {
  animation: fade-up 0.4s ease-out forwards;
}

/* 加载动画（旋转） */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

/* 脉冲动画（呼吸效果） */
@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.animate-pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* ============================
   6. 兼容性修复（解决常见问题）
   ============================ */
/* 修复 Tailwind 与部分组件库的冲突 */
[data-theme="dark"] {
  color-scheme: dark;
}

/* 修复 iOS 上的滚动问题 */
@supports (-webkit-touch-callout: none) {
  .custom-scrollbar {
    -webkit-overflow-scrolling: touch;
  }
}

/* 修复 backdrop-filter 在部分浏览器的兼容性 */
@supports not (backdrop-filter: blur(10px)) {
  .glass-effect,
  .glass-effect-dark {
    @apply bg-white dark:bg-black;
  }
}

/* 修复输入框在自动填充时的样式问题 */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
textarea:-webkit-autofill,
textarea:-webkit-autofill:hover,
textarea:-webkit-autofill:focus,
select:-webkit-autofill,
select:-webkit-autofill:hover,
select:-webkit-autofill:focus {
  @apply bg-[rgb(var(--background-start-rgb))] text-[rgb(var(--foreground-rgb))] border-[rgb(var(--border-rgb))];
  -webkit-text-fill-color: rgb(var(--foreground-rgb));
  -webkit-box-shadow: 0 0 0px 1000px rgb(var(--background-start-rgb)) inset;
  transition: background-color 5000s ease-in-out 0s;
}
